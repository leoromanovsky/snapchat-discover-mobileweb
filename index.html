<!DOCTYPE html>
<html>
<head>
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <link rel="stylesheet" href="http://code.jquery.com/mobile/1.4.5/jquery.mobile-1.4.5.min.css" />

  <style type="text/css">
    html,body{ margin:0; padding:0; height:100%; width:100%; }
  </style>

  <script src="http://code.jquery.com/jquery-1.11.1.min.js"></script>

  <script>
  // Update configuration to our liking
  $( document ).on( "mobileinit", function() {
    $.extend( $.mobile , {
      autoInitializePage: false
    });
  });
</script>
  <script src="http://code.jquery.com/mobile/1.4.5/jquery.mobile-1.4.5.min.js"></script>
  <script>
    (function() {
      var supportTouch = $.support.touch,
              scrollEvent = "touchmove scroll",
              touchStartEvent = supportTouch ? "touchstart" : "mousedown",
              touchStopEvent = supportTouch ? "touchend" : "mouseup",
              touchMoveEvent = supportTouch ? "touchmove" : "mousemove";
      $.event.special.swipeupdown = {
          setup: function() {
              var thisObject = this;
              var $this = $(thisObject);
              $this.bind(touchStartEvent, function(event) {
                  var data = event.originalEvent.touches ?
                          event.originalEvent.touches[ 0 ] :
                          event,
                          start = {
                              time: (new Date).getTime(),
                              coords: [ data.pageX, data.pageY ],
                              origin: $(event.target)
                          },
                          stop;

                  function moveHandler(event) {
                      if (!start) {
                          return;
                      }
                      var data = event.originalEvent.touches ?
                              event.originalEvent.touches[ 0 ] :
                              event;
                      stop = {
                          time: (new Date).getTime(),
                          coords: [ data.pageX, data.pageY ]
                      };

                      // prevent scrolling
                      if (Math.abs(start.coords[1] - stop.coords[1]) > 10) {
                          event.preventDefault();
                      }
                  }
                  $this
                          .bind(touchMoveEvent, moveHandler)
                          .one(touchStopEvent, function(event) {
                      $this.unbind(touchMoveEvent, moveHandler);
                      if (start && stop) {
                          if (stop.time - start.time < 1000 &&
                                  Math.abs(start.coords[1] - stop.coords[1]) > 30 &&
                                  Math.abs(start.coords[0] - stop.coords[0]) < 75) {
                              start.origin
                                      .trigger("swipeupdown")
                                      .trigger(start.coords[1] > stop.coords[1] ? "swipeup" : "swipedown");
                          }
                      }
                      start = stop = undefined;
                  });
              });
          }
      };
      $.each({
          swipedown: "swipeupdown",
          swipeup: "swipeupdown"
      }, function(event, sourceEvent){
          $.event.special[event] = {
              setup: function(){
                  $(this).bind(sourceEvent, $.noop);
              }
          };
      });

  })();
  </script>

  <script>
  var pages = [
    {
      titleCardId: '#page1TitleCard',
      titleBackground: '#BBE8FF',
      contentId: '#page1Content'
    },
    {
      titleCardId: '#page2TitleCard',
      titleBackground: '#A7FFE9',
      contentId: '#page2Content'
    }
  ]
  // title or content
  var currentActivePageType = 'title';
  var currentPage = 0;
  var firstScrollEventOnContent = true;

  function renderTitleCard(index) {
    var contentToRender = $(pages[index].titleCardId);
    $("#contentContainer").html(contentToRender.html());
    $("#contentContainer").css('background-color', pages[index].titleBackground);
  }

  function renderContent(index) {
    var contentToRender = $(pages[index].contentId);
    $("#contentContainer").html(contentToRender.html());
  }

  $(function() {
    renderTitleCard(0);

    $("#contentContainer").on("swipeleft",function() {
      if (currentActivePageType == 'content') {
        return
      }

      if (currentPage == 0) {
        renderTitleCard(1)
        currentPage = 1
      } else {

      }
    });

    $("#contentContainer").on("swiperight",function() {
      if (currentActivePageType == 'content') {
        return
      }

      if (currentPage == 1) {
        renderTitleCard(0)
        currentPage = 0
      } else {

      }
    });

    $("#contentContainer").on("swipeup",function() {
      console.log("swipe up!");

      if (currentActivePageType == 'title') {
          currentActivePageType = 'content'
          firstScrollEventOnContent = true
          renderContent(currentPage);
      } else {

      }
    });

    $("#contentContainer").on("scrollstop",function() {
      if (firstScrollEventOnContent) {
        firstScrollEventOnContent = false
        return
      }

      if (currentActivePageType == 'title') {
        return
      }

      var contentHeight = $(pages[currentPage].contentId).height();
      var scrollTop = $("#contentContainer").scrollTop();
      var containerHeight = $("#contentContainer").height();
      if (scrollTop == 0) {
        // we are at the top
        console.log("at top!")

        renderTitleCard(currentPage)
        currentActivePageType = 'title'

      } else if (contentHeight == (scrollTop + containerHeight)) {
        console.log("at bottom!")
      }
    });
  });
</script>
</head>
<body>
  <div id="contentContainer" style="position: absolute; top: 0; bottom: 0; left: 0; right: 0; overflow-x: scroll;"></div>

  <div id="page1TitleCard" class="card" style="background: color: display: none;">
    <h1>Card 1 Title</h1>
  </div>
  <div id="page2TitleCard" class="card" style="display: none;">
    <h1>Card 2 Title</h1>
  </div>

  <div id="page1Content" class="card" style="display: none; background: yellow">
    <div>
      <h1>Content for Card 1</h1>

      <p>In viverra, ligula eget aliquam ultricies, odio quam euismod augue, sit amet ullamcorper turpis mi vitae nunc.
      Nam pellentesque justo eu mi blandit ultrices. In dictum lacinia felis, non ornare ex commodo id.
      Donec sollicitudin rutrum erat ut tincidunt. Maecenas vestibulum mi ut massa fermentum, sed facilisis purus malesuada.
      Ut pulvinar imperdiet eros eget eleifend. Ut at dui vitae nulla pellentesque eleifend.
      Vivamus consequat dolor nulla, at sagittis arcu consectetur sodales. Sed at arcu a enim volutpat gravida viverra quis diam.</p>

      <p>In viverra, ligula eget aliquam ultricies, odio quam euismod augue, sit amet ullamcorper turpis mi vitae nunc.
      Nam pellentesque justo eu mi blandit ultrices. In dictum lacinia felis, non ornare ex commodo id.
      Donec sollicitudin rutrum erat ut tincidunt. Maecenas vestibulum mi ut massa fermentum, sed facilisis purus malesuada.
      Ut pulvinar imperdiet eros eget eleifend. Ut at dui vitae nulla pellentesque eleifend.
      Vivamus consequat dolor nulla, at sagittis arcu consectetur sodales. Sed at arcu a enim volutpat gravida viverra quis diam.</p>

      <p>In viverra, ligula eget aliquam ultricies, odio quam euismod augue, sit amet ullamcorper turpis mi vitae nunc.
      Nam pellentesque justo eu mi blandit ultrices. In dictum lacinia felis, non ornare ex commodo id.
      Donec sollicitudin rutrum erat ut tincidunt. Maecenas vestibulum mi ut massa fermentum, sed facilisis purus malesuada.
      Ut pulvinar imperdiet eros eget eleifend. Ut at dui vitae nulla pellentesque eleifend.
      Vivamus consequat dolor nulla, at sagittis arcu consectetur sodales. Sed at arcu a enim volutpat gravida viverra quis diam.</p>

      <p>In viverra, ligula eget aliquam ultricies, odio quam euismod augue, sit amet ullamcorper turpis mi vitae nunc.
      Nam pellentesque justo eu mi blandit ultrices. In dictum lacinia felis, non ornare ex commodo id.
      Donec sollicitudin rutrum erat ut tincidunt. Maecenas vestibulum mi ut massa fermentum, sed facilisis purus malesuada.
      Ut pulvinar imperdiet eros eget eleifend. Ut at dui vitae nulla pellentesque eleifend.
      Vivamus consequat dolor nulla, at sagittis arcu consectetur sodales. Sed at arcu a enim volutpat gravida viverra quis diam.</p>

      <h3>End of card 1</h3>
    </div>
  </div>

  <div id="page2Content" class="card" style="display: none; background: blue">
    <div>
      <h1>Content for Card 2</h1>

      <p>Duis tincidunt est non magna tincidunt sollicitudin eget id ante.
      Praesent in lorem dapibus, malesuada magna in, interdum lectus.
      Sed aliquam dolor dolor, eu pretium arcu dictum vel.
      Nunc ac ante sed nunc vulputate pellentesque.
      Nunc sit amet ante feugiat, consequat enim ac, finibus nulla.
      Aliquam urna erat, auctor sed sagittis eget, tempor id nisi.
      Aliquam erat volutpat. In finibus a turpis a sollicitudin.
      Vivamus luctus bibendum nisl, id condimentum velit porttitor non. Integer ut ultricies libero. Proin quis felis in
      lectus faucibus ultricies sed ac ex. Proin ut ex congue, placerat justo eu, dignissim lectus.
      In feugiat dui nec purus mattis suscipit.
      Suspendisse et leo elit. Aenean sed venenatis mi, volutpat elementum erat.</p>

      <p>Duis tincidunt est non magna tincidunt sollicitudin eget id ante.
      Praesent in lorem dapibus, malesuada magna in, interdum lectus.
      Sed aliquam dolor dolor, eu pretium arcu dictum vel.
      Nunc ac ante sed nunc vulputate pellentesque.
      Nunc sit amet ante feugiat, consequat enim ac, finibus nulla.
      Aliquam urna erat, auctor sed sagittis eget, tempor id nisi.
      Aliquam erat volutpat. In finibus a turpis a sollicitudin.
      Vivamus luctus bibendum nisl, id condimentum velit porttitor non. Integer ut ultricies libero. Proin quis felis in
      lectus faucibus ultricies sed ac ex. Proin ut ex congue, placerat justo eu, dignissim lectus.
      In feugiat dui nec purus mattis suscipit.
      Suspendisse et leo elit. Aenean sed venenatis mi, volutpat elementum erat.</p>

      <p>Duis tincidunt est non magna tincidunt sollicitudin eget id ante.
      Praesent in lorem dapibus, malesuada magna in, interdum lectus.
      Sed aliquam dolor dolor, eu pretium arcu dictum vel.
      Nunc ac ante sed nunc vulputate pellentesque.
      Nunc sit amet ante feugiat, consequat enim ac, finibus nulla.
      Aliquam urna erat, auctor sed sagittis eget, tempor id nisi.
      Aliquam erat volutpat. In finibus a turpis a sollicitudin.
      Vivamus luctus bibendum nisl, id condimentum velit porttitor non. Integer ut ultricies libero. Proin quis felis in
      lectus faucibus ultricies sed ac ex. Proin ut ex congue, placerat justo eu, dignissim lectus.
      In feugiat dui nec purus mattis suscipit.
      Suspendisse et leo elit. Aenean sed venenatis mi, volutpat elementum erat.</p>

      <h3>End of card 2</h3>
    </div>
  </div>
</body>
</html>
